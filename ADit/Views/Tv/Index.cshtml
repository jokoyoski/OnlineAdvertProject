@model ADit.Interfaces.ITVTransactionUIView
@{
    ViewBag.Title = "Buy television advert";
}


@using (Html.BeginForm("Index", "Tv", FormMethod.Post, new {id = "editForm", enctype = "multipart/form-data", encoding = "multipart/form-data"}))
{
    @Html.AntiForgeryToken()

    <div class="container-fluid">
    <div class="row no-gutters">
    <div class="card col-md-10 m-auto">
        <div class="card-header">
            <h4>Buy Television Advert</h4>
        </div>

        <div class="card-body">

            <p class="text-danger">@Html.ValidationSummary()</p>
            <p class="text-danger"> @Model.ProcessingMessage</p>

            <div class="form-group">
                <label class="control-label"> Enter your Order Title: <span class="text-danger">*</span></label>
                <div class="">
                    <input id="OrderTitle" name="OrderTitle" required class="form-control" type="text" maxlength="100" value="@Model.OrderTitle"/>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        <label class="control-label"> Do you have a Script or Production Material: <span class="text-danger">*</span></label>
                        <div class="data" style="overflow: hidden;">
                            @Html.DropDownList("ScriptingMaterialCode", Model.ScriptQuestion, new {@class = "form-control", id = "MaterialQuestionId"})
                        </div>
                    </div>
                </div>
            </div>


            <div class="row">

                <div class="col-md-6 scriptingMaterialSection hide" id="scriptingMaterialSection">
                    <div class="form-group">
                        <label class="control-label"> Upload your script material: <span class="text-danger">*</span></label>
                        <div class="data" style="overflow: hidden">
                            <input type="file" id="scriptingMaterial" name="scriptingMaterial" class="form-control"
                                   accept=".txt,.doc,.jpg ,.docx,.pdf" title="Upload your script"/>
                        </div>
                    </div>
                </div>

                <div class="col-md-6 productionMaterialSection hide" id="productionMaterialSection">
                    <div class="form-group  ">
                        <label class="control-label"> Upload your production material: <span class="text-danger">*</span></label>
                        <div class="data" style="overflow: hidden">
                            <input type="file" id="productionMaterial" name="productionMaterial" class="form-control"
                                   accept=".mp3,.mp4,.jpg,jpeg,.doc,.pdf" title="Upload your video"/>
                        </div>
                    </div>
                </div>
            </div>


            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        <label class="control-label"> Do you have APCON Approval: <span class="text-danger">*</span></label>
                        <div class="data" style="overflow: hidden;">
                            @Html.DropDownList("ApconApprovalTypeId", Model.ApconApprovalType, new {@class = "form-control", id = "ApconApprovalTypeId"})
                        </div>
                    </div>
                </div>

                <div class="col-md-6 ApconApproval hide" id="ApconApproval">
                    <div class="form-group">
                        <label class="control-label"> APCON Type Price:</label>
                        <div class="data" style="overflow: hidden">
                            <input type="text" id="ApconPrice" readonly name="ApconApprovalAmount" class="form-control" value="@Model.ApconApprovalAmount.ToString("00,0")"/>
                            <input type="text" id="selectedApconTypePriceId" hidden name="ApconApprovalTypePriceId" class="form-control" value="@Model.ApconApprovalTypePriceId"/>
                        </div>
                    </div>
                </div>


            </div>

            <div class="row">
                <div class="col-md-6 hide ApconApprovalNumberSection" id="ApconApprovalNumberSection">
                    <div class="form-group ">
                        <label class="control-label"> Enter your Apcon Number: <span class="text-danger">*</span></label>
                        <div class="data" style="overflow: hidden">
                            <input type="text" name="ApconApprovalNumber" id="ApconNumber" class="form-control" maxlength="100" value="@Model.ApconApprovalNumber" class=""/>
                        </div>
                    </div>
                </div>
            </div>


            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        <label class="control-label"> Type Of Material: <span class="text-danger">*</span></label>
                        <div class="data" style="overflow: hidden;">
                            @Html.DropDownList("MaterialTypeId", Model.ActiveMaterialType, new {@class = "form-control", id = "MaterialTypeId"})
                        </div>
                    </div>
                </div>

            </div>

            <div id="material">


                <div class="row">
                    <div class="form-group scriptingPriceSection  col-md-6" id="scriptingPriceSection">
                        <label class="control-label"> Scripting Price: <span class="text-danger">*</span></label>
                        <div class="data" style="overflow: hidden">
                            <input type="text" id="selectedMaterialScriptPrice" readonly name="ScriptingAmount" class="form-control" value="@Model.ScriptingAmount.ToString("00,0")"/>
                            <input type="text" id="selectedScriptingTypeId" hidden name="MaterialScriptingTypeId" class="form-control" value="@Model.MaterialScriptingPriceId"/>
                        </div>
                    </div>

                    <div class="form-group productionPriceSection  col-md-6" id="productionPriceSection">
                        <label class="control-label"> Production Price: <span class="text-danger">*</span></label>
                        <div class="data" style="overflow: hidden">
                            <input type="text" id="selectedMaterialProductionPrice" readonly name="ProductionAmount" class="form-control" value="@Model.ProductionAmount.ToString("00,0")"/>
                            <input type="text" id="selectedMaterialProductionTypeId" hidden name="MaterialProductionTypeId" class="form-control" value="@Model.MaterialProductionPriceId"/>
                        </div>
                    </div>
                </div>

            </div>

            <div class="form-group">
                <label class="control-label"> Enter addition airing instructions: <span class="text-danger">*</span></label>
                <div class="data" style="overflow: hidden">
                    <textarea id="AiringDescription" name="AiringInstruction" required class="form-control">@Model.AiringInstruction</textarea>
                </div>
            </div>

        </div>
    </div>


    <!-- Television Station Selection View Here -->
    @if (Model.TvStationList.Any())
    {
        <div class="columns" style="font-size: 12px; width: 100%; font-style: italic;">
            Hold down the shift key to sort with multiple columns.
        </div>
        <div class="table-responsive container-fluid">
            <table id="tableList" class="table" style="border-color: transparent">
                <colgroup>
                    <col style="width: 20px;" />
                    <col style="width: 200px;" />
                    <col style="width: 70px;" />
                    <col style="width: 70px;" />
                    <col style="width: 40px;" />
                    <col style="width: 155px;" />
                    <col style="width: 185px;" />
                    <col style="width: 50px;" />
                    <col style="width: 70px;" />
                    <col style="width: 80px;" />
                    <col style="width: 80px;" />

                </colgroup>
                <thead class="thead-light">
                    <tr>

                      
                        <th></th>
                        <th>TV Stations</th>
                       
                        <th data-sorter="false">StartDate</th>
                        <th data-sorter="false">EndDate</th>
                        <th data-sorter="false">#  of Days</th>
                        <th data-sorter="false">Duration</th>
                        <th data-sorter="false">Time Belt</th>
                        <th data-sorter="false">Slots per day</th>
                        <th data-sorter="false"> Total Slots</th>
                        <th data-sorter="false"> Price per Slot</th>
                        <th data-sorter="false"> Total</th>
                    </tr>
                </thead>
                <tbody>
                    @{ var i = 0;}
                    @foreach (var d in Model.AiringDetailsList)
                    {
                        var checkBoxId = "checkBox_" + d.TvStationId;
                        var disabledStr = d.IsSelected ? "false" : "disabled";

                        var timingIdName = "transactionAiring[" + i + "].TimingId";
                        var timingDDL = Model.GetTimingDDL(d.TimingId);

                        var timingBeltName = "transactionAiring[" + i + "].TimeBeltId";
                        var timingBeltDDL = Model.GetTimingBeltDDL(d.TimeBeltId);
                    <tr style="width: 100%;">


                       

                        <td style="border: 1px solid #FFF !important;">
                            <input type="checkbox" id="@checkBoxId" name="selectedTvStationIds" value="@d.TvStationId" class="form-control"
                                   @DisplayHelper.Checked(d.IsSelected) />

                            <input type="hidden" id="transactionAiring[@i].TvStationId" name="transactionAiring[@i].TvStationId" value="@d.TvStationId" />
                        </td>

                        
                        <td style="border: 1px solid #FFF !important; width: 250px">
                            @Model.GetTvStationDescription(d.TvStationId)
                        </td>
                        <td>
                            <div class="input-group input-daterange ">
                                <input type="date" id="startDate_@d.TvStationId" value="@DisplayHelper.DisplayDate(d.StartDate)" name="transactionAiring[@i].StartDate" disabled="disabled" />
                                <input type="hidden" id="dayscalc_@d.TvStationId" value="" />



                             
                                &nbsp;

                                


                            </div>
                        </td>
                        <td>

                            <input type="date" id="endDate_@d.TvStationId" value="@DisplayHelper.DisplayDate(d.EndDate)" name="transactionAiring[@i].EndDate" disabled="disabled" />

                        </td>
                        <td>
                            <p id="days_@d.TvStationId" style="font-size: 15px" class="text-right"> 0  </p>
                        </td>
                        <td>
                            @{ timingIdName = "transactionAiring[" + i + "].TimingId"; }

                            @{ timingDDL = Model.GetTimingDDL(d.TimingId); }

                            @Html.DropDownList("transactionAiring[" + i + "].TimingId", timingDDL, new { @class = "TimingId form-control", id = "timingCode_" + d.TvStationId, disabled = "disabled" })
                               
                        </td>
                        <td>
                            @Html.DropDownList(timingBeltName, timingBeltDDL, new { @class = "timeBeltId form-control", id = "timeBelt_" + d.TvStationId, disabled = "disabled" })
                        </td>
                        <td style="border: 1px solid #FFF !important; width: 100px">
                            <input type="text" id="slots_@d.TvStationId" name="transactionAiring[@i].Slots" class="slots form-control" value="@DisplayHelper.DisplayInt(d.Slots)" maxlength="3" disabled="disabled" />
                        </td>
                        <td style="border: 1px solid #FFF !important; width: 100px">
                            <input type="text" class="totalSlots form-control" id="totalSlots_@d.TvStationId" readonly name="transactionAiring[@i].totalSlots"
                                   value="@DisplayHelper.DisplayInt(d.TotalSlots)" maxlength="3" disabled="disabled" />
                        </td>

                        <td style="border: 1px solid #FFF !important; width: 100px">
                            <span id="slotPrice_@d.TvStationId">&#8358; 0:00</span>
                        </td>
                        <td width="100">
                            <input type="hidden" id="amount_@d.TvStationId" readonly name="transactionAiring[@i].Price" class="form-control" value="@d.Price" />
                            <input type="hidden" id="totalamount_@d.TvStationId" readonly name="ScriptingAmount" class="form-control" value="0" />
                            <span id="textamount_@d.TvStationId">&#8358;0:00</span>
                        </td>
                    </tr>
                        i++;


                        
                    }
                </tbody>
            </table>

        </div>
        <div class="columns" style="margin-top: 10px; width: 100%;">
            <div class="column">
                @DisplayHelper.TablePager(Model.TvStationList.Count())
            </div>
        </div>
    }
    else
    {
        <div class="columns" style="font-size: 12px; margin-left: 15px; margin-top: 15px; margin-top: 15px; width: 100%;">
            <div class="validation-summary-errors">
                You do not have any television station selected for this transaction
            </div>
        </div>
    }

    <div class="pt-0 col-md-12">
        
            <input type="hidden" readonly id="finalAmount" name="finalAmount" value="@Model.FinalAmount.ToString("00,0")"/>

            <div class="offset-9">
                <div class="">
                    <h3 id="text_finalAmount" style="font-size: 20px" class="text-right">
                        Price : 0.00
                    </h3>
                </div>
                <div class="">
                    <input type="submit" value="Add To Cart" class="btn btn-danger pull-right" />
                </div>
            </div>
            
       
    </div>


    </div>


    <!--Total Price Holder-->


    </div>
}

@section JavaScriptsExecution
{

    <script type="text/javascript">
        $(document).ready(function() {
            $(function() {
                $('#tableList').tablesorter({
                    theme: 'blue',
                    headers: { 3: { sorter: false }, 4: { sorter: false } },
                    widthFixed: true,
                    widgets: ['zebra'],
                    size: 50
                }).tablesorterPager({ container: $("#pager"), size: 50 });
            });

            // popup page
            var $popupDialog = $('<div></div>').dialog({
                autoOpen: false,
                width: 750,
                modal: true,
                title: '',
                closeText: "",
                closeOnEscape: true,
                resizable: true
            });


        });
    </script>


}


@section JavaScriptsIncludes
{
    <script src="/Scripts/jquery-ui-1.12.1.js" type="text/javascript"></script>
    <script src="/Scripts/tablesorter/jquery.tablesorter.js" type="text/javascript"></script>
    <script src="/Scripts/tablesorter/jquery.tablesorter.widgets.js" type="text/javascript"></script>
    <script src="/Scripts/tablesorter/jquery.tablesorter.pager.js" type="text/javascript"></script>
    <script src="~/Scripts/services/tvService.js" type="text/javascript"></script>


    <script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>

}

@section Stylesheets
{
    <link href="/Content/themes/base/all.css" rel="stylesheet" type="text/css"/>
    <link href="/Content/tablesorter/theme.blue.css" rel="stylesheet" type="text/css"/>
    <link href="/Content/tablesorter/jquery.tablesorter.pager.css" rel="stylesheet" type="text/css"/>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css"/>

}